#!/bin/bash

nsname=$1
mparams=$2
omegaparams=$3
nsamps=$4
conflvl=$5
outdir=$6

echo $nsname > "$outdir/${nsname}_params.in"
echo $mparams >> "$outdir/${nsname}_params.in"
echo $omegaparams >> "$outdir/${nsname}_params.in"
echo $nsamps >> "$outdir/${nsname}_params.in"
echo $conflvl >> "$outdir/${nsname}_params.in"
echo $outdir >> "$outdir/${nsname}_params.in"

inferprops $nsname -v -p I,chi -D genbetaprime,truncated,gaussian -P 1.+0.934305+2.85628+191.509,$mparams,$omegaparams -n $nsamps -o $outdir/

plothist "${nsname}_props.csv" -x I -t I -b 100 -d $outdir/ -o $outdir/ -f rotpost_ -A "\$I\$ [10\$^{45}\$ g cm\$^2\$]",""
plothist "${nsname}_props.csv" -x chi -t chi -b 100 -d $outdir/ -o $outdir/ -f rotpost_ -A "\$\chi\$",""

plothist "${nsname}_props.csv" -x M -t m -b 100 -d $outdir/ -o $outdir/ -f rotprior_ -A "\$m\$ [\$M_{\odot}\$]",""
plothist "${nsname}_props.csv" -x Omega -t Omega -b 100 -d $outdir/ -o $outdir/ -f rotprior_ -A "\$\Omega\$",""

calcintervals -v "${nsname}_props.csv" -p M,Omega,I,chi -L $conflvl -d $outdir/ -o $outdir/
