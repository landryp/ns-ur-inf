#!/bin/bash

nsname=$1
sampsfile=$2
sampscols=$3
nsamps=$4
conflvl=$5
outdir=$6

echo $nsname > "$outdir/${nsname}_params.in"
echo $sampsfile >> "$outdir/${nsname}_params.in"
echo $sampscols >> "$outdir/${nsname}_params.in"
echo $nsamps >> "$outdir/${nsname}_params.in"
echo $conflvl >> "$outdir/${nsname}_params.in"
echo $outdir >> "$outdir/${nsname}_params.in"

inferprops $nsname -v -p I,Omega -D genbetaprime,samples,samples -P 1.+0.934305+2.85628+191.509,$sampsfile,$sampsfile -s $sampscols -n $nsamps -o $outdir/

plothist "${nsname}_props.csv" -x I -t I -b 100 -d $outdir/ -o $outdir/ -f rotpost_ -A "\$I\$ [10\$^{45}\$ g cm\$^2\$]",""
plothist "${nsname}_props.csv" -x Omega -t Omega -b 100 -d $outdir/ -o $outdir/ -f rotpost_ -A "\$\Omega\$ [rad/s]",""

plothist "${nsname}_props.csv" -x M -t m -b 100 -d $outdir/ -o $outdir/ -f rotprior_ -A "\$m\$ [\$M_{\odot}\$]",""
plothist "${nsname}_props.csv" -x chi -t chi -b 100 -d $outdir/ -o $outdir/ -f rotprior_ -A "\$\chi\$",""

calcintervals -v "${nsname}_props.csv" -p M,chi,I,Omega -L $conflvl -d $outdir/ -o $outdir/
